<h1>Show cross</h1>
<% g_user = User.find(@cross.user_id) %>

<div class="row">
<div class="large-2 column">
<a href="mailto:<%= g_user.email %>" alt="<%= g_user.email %>" title="<%= g_user.email %>">
<%= image_tag g_user.gravatar_url, :class=> "img-circular" %>
</a>
</div>
<div class="large-5 column">
<% if @cross.parent.to_i >= 1 %>
<a href="<%= short_path %>/history"><i class="fi-page-multiple"></i> Cross history</a>
<br />
<% end %>
<a href="<%= short_path %>/qr"><i class="fi-camera"></i> QR code</a>
<br />
<% if user_signed_in?
if g_user.id == current_user.id %>
<%= link_to @cross, method: :delete, data: { confirm: "Are you sure? The cross and all it's derivatives would be deleted." } do %>
	<i class="fi-trash" ></i> Delete cross
<% end %> 
<% else %>
<%= link_to copy_path do %>
	<i class="fi-page-copy" ></i> Copy cross
<% end %>
<% end %>
<% end %>
</div>
<div class="large-5 column">
	<p><%= @cross.crossdate.strftime("Crossed on %B %d, %Y") %><br />
	<%= @cross.description %></p>
</div>
</div>
<br />

<div class="panel">
	\[\underbrace{

&#x2642; \quad 

<% semikolon = 0 %>
<% @parent_male.each do |chr| %>
		<% if chr.size > 1 %>
			<% if semikolon != 0 %>;<% end %>
			<% chr %>
			\dfrac
			<% chr.each do |n| %>
				{<%= n %>}
			<% end %>
		<% else %>
			<% if semikolon != 0 %>;<% end %>
			<% chr.each do |n| %>
				<%= n %>
			<% end %>
		<% end %> 
		<% semikolon = 1 %>
	<% end %> 

\qquad X \qquad 

<% semikolon = 0 %>
<% @parent_female.each do |chr| %>
		<% if chr.size > 1 %>
			<% if semikolon != 0 %>;<% end %>
			<% chr %>
			\dfrac
			<% chr.each do |n| %>
				{<%= n %>}
			<% end %>
		<% else %>
			<% if semikolon != 0 %>;<% end %>
			<% chr.each do |n| %>
				<%= n %>
			<% end %>
		<% end %> 
		<% semikolon = 1 %>
	<% end %>
\quad &#x2640;
}\]

<% 
if user_signed_in?
if g_user.id == current_user.id
%>
<p>
  <a href="<%= short_path %>" class="button small secondary">Fly view</a>
  <a href="<%= short_path %>/chr" class="button small secondary">Chromosome view</a>
  <a href="<%= short_path %>/pnt" class="button small disabled">Punnett square</a>
</p>
<% end end %>

<table align="center">
  <tbody>

  	<% c = 0 %>
  	<% r = 0 %>
  	<% n = 0 %>

  	<% while c < @square + 1  do %>
    	<tr>
    		<% while r < @square + 1 do %>
    			<% if r == 0 and c == 0 %>
    				<td>&#x2642; / &#x2640;</td>
    			<% elsif r == 0 %>
    				<td><small>\[
    					<% counter = @male_chrs[c-1].size %>
    					<% @male_chrs[c-1].each do |single| %>
    						<%= single %>
    						<% counter = counter - 1 %>
    						<% if counter > 0 %>;<% end %>
    					<% end %>
    				\]</small></td>
    			<% elsif c == 0 %>
    				<td><small>\[
    					<% counter = @female_chrs[c-1].size %>
    					<% @female_chrs[r-1].each do |single| %>
    						<%= single %>
    						<% counter = counter - 1 %>
    						<% if counter > 0 %>;<% end %>
    					<% end %>
    				\]</small></td>
    			<% else %>
      				<td><small>\[
      					<%
      					counter = @male_chrs[c-1].size
      					@male_chrs[c-1].each do |single|%>
      						
      						\dfrac{<%=@female_chrs[r-1][@male_chrs[c-1].size-counter]%>}{<%=single%>}

      						<% counter = counter - 1
    						if counter > 0
    							%>;<%
    						end
      					end
      					%>
      				\]</small></td>
      				<% n = n + 1 %>
      			<% end %>
      			<% r = r + 1 %>
      		<% end %>
    	</tr>
    	<% r = 0 %>
    	<% c = c + 1 %>
    <% end %>
  </tbody>
</table>